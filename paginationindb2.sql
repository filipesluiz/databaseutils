WITH R AS (
	    SELECT ROW_NUMBER() OVER (ORDER BY T.NU_FUGY29) AS NU_SQ_CONSULTA,
		NU_FUGY29, 
		NU_FUGB11,
		NU_FUGY50,
		NU_FUGY27,
		VALOR_DEBITO
FROM (		
SELECT 
		Y29.NU_FUGY29, 
		Y29.NU_FUGB11,
		Y29.NU_FUGY50,
		Y29.NU_FUGY27,
		(Y29.VR_DEBITO_APURADO - IFNULL(Y29PART.VR_DEBITO_APURADO, 0)) VALOR_DEBITO
	FROM FUGVWY35_PARCELAMENTO Y35
	INNER JOIN FUGVWY46_FORMA_COBRANCA Y46
		ON Y46.NU_FUGY46 = Y35.NU_FUGY46
	INNER JOIN FUGVWY42_ABRANGENCIA_COBRANCA Y42
		ON Y42.NU_FUGY46 = Y46.NU_FUGY46
	INNER JOIN FUGVWY29_COMPOSICAO_CARTEIRA Y29
		ON Y29.NU_FUGY29 = Y42.NU_FUGY29
	LEFT JOIN (
				SELECT SUM(VR_DEBITO_APURADO) VR_DEBITO_APURADO, NU_DEBITO_PRINCIPAL_FUGY29 
				FROM FUGVWY29_COMPOSICAO_CARTEIRA
				GROUP BY NU_DEBITO_PRINCIPAL_FUGY29) Y29PART
		ON Y29PART.NU_DEBITO_PRINCIPAL_FUGY29 = Y29.NU_FUGY29
	LEFT JOIN FUGVWY39_ABRANGENCIA_ITEM_COBRANCA Y39
		ON Y39.NU_FUGY29 = Y29.NU_FUGY29		
	INNER JOIN FUGVWY50_APURACAO_DEBITO Y50
		ON Y50.NU_FUGY50 = Y29.NU_FUGY29
	INNER JOIN FUGVWY06_RUBRICA_ITEM_DEBITO Y06
		ON Y06.NU_FUGY06 = Y50.NU_FUGY06
	INNER JOIN FUGVWY04_ITEM_DEBITO Y04
		ON Y04.NU_FUGY04 = Y06.NU_FUGY04
	WHERE Y35.NU_PARCELAMENTO = 2018200013 
	AND Y04.NU_COMPETENCIA = 201502
	AND Y29.IC_QUITADO = 'N' 
	AND Y29.IC_PRINCIPAL = 'S'
	AND Y39.NU_FUGY39 IS NULL) T )
	SELECT R.*
           , RC.QT_REGISTRO
    FROM R, (SELECT COUNT(*) AS QT_REGISTRO FROM R) AS RC
    WHERE R.NU_SQ_CONSULTA > (10 * (2-1))
    AND R.NU_SQ_CONSULTA <= (10 * 2)
    ORDER BY R.NU_SQ_CONSULTA
    WITH CS;
--10 = QTD_REGISTROS_POR_PAGINA
--2 = NU_PAGINA_ATUAL
